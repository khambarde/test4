{"triggers":[],"nodes":[{"uid":"a62d43ad-e7b1-4e57-a288-9cb769b6f6a9","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"yyyy-MM-dd"}}],"returnTo":{"type":"VARIABLE","variableName":"Date"}},{"uid":"baa16d98-3c99-416d-b527-46dfc9519386","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file:///D:/HPUBOT_LOG/$Date$_Auto.txt"}},{"name":"logContent","value":{"type":"STRING","string":"Start Here"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"ca30b3d1-c752-448e-af98-3f99ab3fea6d","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"b05a8822-4d3c-4364-af10-a776b71620fa","commandName":"python.commands.openScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"CutOff"}},{"name":"scriptOption","value":{"type":"STRING","string":"FILE"}},{"name":"file","value":{"type":"FILE","string":"file:///D:/vijay/RunOnCutOffDateFile.py"}},{"name":"version","value":{"type":"STRING","string":"3"}}]},{"uid":"810ec06c-ae12-45d7-8178-f78b8d651663","commandName":"python.commands.executeFunction","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"CutOff"}},{"name":"functionName","value":{"type":"STRING","string":"RunOnCutOffDateFun()"}}]},{"uid":"98300727-8210-470b-a95f-253d60ba3ef5","commandName":"python.commands.closeScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"CutOff"}}]},{"uid":"a4586102-ba83-4757-bf3c-3cef581e126c","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"connectionMode","value":{"type":"STRING","string":"USER"}},{"name":"databaseProvider","value":{"type":"STRING","string":"SQLOLEDB.1"}},{"name":"server","value":{"type":"STRING","string":"NDS-AA-02"}},{"name":"database","value":{"type":"STRING","string":"HPU"}},{"name":"user","value":{"type":"STRING","string":"RPA"}},{"name":"auth","value":{"type":"STRING","string":"nds1@2020"}},{"name":"instance","value":{"type":"STRING","string":""}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"c08f05a0-b531-45ec-a0d0-81fafdaad6c7","commandName":"emailConnect","packageName":"Email","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"EmailSession"}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}}]},{"uid":"9f8f90cd-948b-4676-a6a9-53fcb5260e52","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"bc9301d0-ddc7-4303-9da7-2c3fdeb35e38","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$UnReadMail{emailSubject}$"}}],"returnTo":{"type":"VARIABLE","variableName":"EmailSubject"}},{"uid":"e3a02bc6-1c32-4307-8d2f-279af8992f64","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$UnReadMail{emailMessage}$"}}],"returnTo":{"type":"VARIABLE","variableName":"EmailMessage"}},{"uid":"f3175edb-bed0-4f06-9fda-c854bfe55344","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$UnReadMail{emailFrom}$"}}],"returnTo":{"type":"VARIABLE","variableName":"From_Email"}},{"uid":"54520952-bbe5-4bd1-9107-001f49b37e46","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$UnReadMail{emailReceivedDate}$"}}],"returnTo":{"type":"VARIABLE","variableName":"Email_ReceivedDate"}},{"uid":"1470a5ba-a16f-4bff-bb64-97b065402db2","commandName":"store","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","string":"USP_InsertEmailLog"}},{"name":"entryList","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"inOrOutParamter","value":{"type":"STRING","string":"Input"}},{"key":"parametername","value":{"type":"STRING","string":""}},{"key":"parametervalue","value":{"type":"STRING","expression":"$EmailSubject$"}},{"key":"outputParamType","value":{"type":"STRING","string":"VARCHAR"}}]},{"type":"DICTIONARY","dictionary":[{"key":"inOrOutParamter","value":{"type":"STRING","string":"Input"}},{"key":"parametername","value":{"type":"STRING","string":"MAIL_BODY"}},{"key":"parametervalue","value":{"type":"STRING","expression":"$EmailMessage$"}},{"key":"outputParamType","value":{"type":"STRING","string":"VARCHAR"}}]},{"type":"DICTIONARY","dictionary":[{"key":"inOrOutParamter","value":{"type":"STRING","string":"Input"}},{"key":"parametername","value":{"type":"STRING","string":"FROM_EMAIL_ADDRESS"}},{"key":"parametervalue","value":{"type":"STRING","expression":"$From_Email$"}},{"key":"outputParamType","value":{"type":"STRING","string":"VARCHAR"}}]},{"type":"DICTIONARY","dictionary":[{"key":"inOrOutParamter","value":{"type":"STRING","string":"Input"}},{"key":"parametername","value":{"type":"STRING","string":"EMAIL_DATE_TIME"}},{"key":"parametervalue","value":{"type":"STRING","expression":"$Email_ReceivedDate$"}},{"key":"outputParamType","value":{"type":"STRING","string":"VARCHAR"}}]}]}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"EmailLogID"}},{"uid":"8f5e6627-863d-4da7-a116-76eb1553fc04","commandName":"python.commands.openScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default1"}},{"name":"scriptOption","value":{"type":"STRING","string":"SCRIPT"}},{"name":"script","value":{"type":"STRING","string":"\n\n# -*- coding: utf-8 -*-\n\"\"\"\nCreated on Sat Oct 24 15:09:40 2020\n\n@author: dmohanty\n\"\"\"\nimport pandas as pd\nimport pyodbc \nimport os\nfrom datetime import datetime\nfrom datetime import date\nimport traceback\ntoday = date.today()\n\npath = 'D:/HPUBOT_LOG/CLIENT_CLASSIFICATION/'\n\n\n\n\nconn_str = (\n    r'DRIVER={SQL Server};'\n    r'SERVER=NDS-AA-02;'\n    r'DATABASE=HPU_DEV;'\n    r'Trusted_Connection=no;'\n    r'UID=RPA;'\n    r'PWD=nds1@2020;'\n    r'autocommit=True'\n)\n\npath = 'D:/HPUBOT_LOG/CLIENT_CLASSIFICATION/'\n\ngblclientId ='0'\ngblinemailid ='0'\n\ndef loginfo(traceback, additionalinfo):\n    isdir = os.path.isdir(path)  \n    if isdir == False:\n        os.makedirs(path)\n    try:\n        file_object  = open(path+\"\\\\\"+str(today)+\".txt\", \"a\") \n        file_object.write(str(datetime.now())[0:19]+'|'+'InEmailId:'+gblinemailid+'|'+additionalinfo+\"|\"+str(traceback)+str(\"\\n\"))\n        file_object.close()\n    finally:\n        if file_object != None:\n            file_object.close()\n            \n    \n\ndef ClassifySenderEmail():\n    #conhdr = pyodbc.connect(conn_str)\n    global gblclientId\n    global gblinemailid\n    try:\n        try:\n            cnxn = pyodbc.connect(conn_str)\n            sqlExecSP=\"{call USP_GetMailsToBeClassifiedForClient }\"\n            dfMailListToBeClassified = pd.read_sql_query(sql=sqlExecSP, con=cnxn)\n            cnxn.close()\n        except Exception:\n            cnxn.close()\n            raise\n        \n        for rowclientindex in dfMailListToBeClassified.index:\n            print(rowclientindex, dfMailListToBeClassified['ID'][rowclientindex],dfMailListToBeClassified['FROM_EMAIL_ADDRESS'][rowclientindex],dfMailListToBeClassified['SUBJECT'][rowclientindex])\n            inemailid=int(dfMailListToBeClassified['ID'][rowclientindex])\n            gblinemailid = str(inemailid)\n            senderemailaddress=dfMailListToBeClassified['FROM_EMAIL_ADDRESS'][rowclientindex]\n            receivedmailsubjectbody=dfMailListToBeClassified['SUBJECT'][rowclientindex]+' '+dfMailListToBeClassified['MAIL_BODY'][rowclientindex]\n            #cnxn = pyodbc.connect(conn_str)\n            outputmsg=''\n            ismailclassified=False\n            classifiedclientid=0\n            classifiedclientname=''\n            try:\n                cnxn = pyodbc.connect(conn_str)\n                sqlExecSP=\"{call USP_GetClientListFromIncomingEmailId (?)}\"\n                params = (senderemailaddress,)\n                dfClientIncomingEmails = pd.read_sql_query(sql=sqlExecSP, con=cnxn, params=params)\n                cnxn.close()\n            except Exception:\n                cnxn.close()\n                raise\n           \n                \n            \n            #print (dfClientIncomingEmails)\n            #print( len(dfClientIncomingEmails.index))\n            if(dfClientIncomingEmails.shape[0] > 0):\n                if(dfClientIncomingEmails.shape[0] > 1):\n                    try:\n                        cnxn = pyodbc.connect(conn_str)\n                        sqlExecSP=\"{call USP_GetCrosswalkKeyListFromIncomingEmailId (?)}\"\n                        params = (senderemailaddress,)\n                        dfClientCrosswalkKeywords = pd.read_sql_query(sql=sqlExecSP, con=cnxn, params=params)\n                        cnxn.close()\n                    except Exception:\n                        cnxn.close()\n                        raise\n                    #print (dfClientIncomingEmails)\n                    #print( len(dfClientCrosswalkKeywords.index))\n                    formattedmailsubjectbody=receivedmailsubjectbody.upper().replace(\" \",\"\")\n                    for rowindex in dfClientCrosswalkKeywords.index:\n                        #print(rowindex, dfClientCrosswalkKeywords['MAIL_KEY_WORD'][rowindex],dfClientCrosswalkKeywords['CLIENT_ID'][rowindex],dfClientCrosswalkKeywords['CLIENT_NAME'][rowindex])\n                        formattedkeyword=dfClientCrosswalkKeywords['MAIL_KEY_WORD'][rowindex]\n                        formattedkeyword=formattedkeyword.upper().replace(\" \",\"\")\n                        if formattedkeyword in formattedmailsubjectbody:\n                            outputmsg='2-Mail classiifed successfully'\n                            ismailclassified=True\n                            classifiedclientid= dfClientCrosswalkKeywords['CLIENT_ID'][rowindex]\n                            classifiedclientname=dfClientCrosswalkKeywords['CLIENT_NAME'][rowindex]\n                            break\n                    if ismailclassified == False :\n                        outputmsg='4-Mail could not be classified. keyword is not matching'\n                    \n                else:\n                    outputmsg='1-Mail classiifed successfully'\n                    ismailclassified=True\n                    classifiedclientid= dfClientIncomingEmails['CLIENT_ID'][0]\n                    classifiedclientname=dfClientIncomingEmails['CLIENT_NAME'][0]      \n            else:\n                outputmsg='3-Mail could not be classified. Sender email id s not found in database'\n            #cnxnnew = pyodbc.connect(conn_str)\n            try:\n                cnxn = pyodbc.connect(conn_str)\n                cur = cnxn.cursor()\n                sqlExecSP=\"{call USP_UPDATEMAILCLASSIFICATIONCLIENTIDNew (?,?,?,?)}\"\n                cur.execute(sqlExecSP,int(inemailid),senderemailaddress,int(classifiedclientid),outputmsg)\n                cnxn.commit()\n                cur.close()\n                cnxn.close()\n            except Exception:\n                cur.close()\n                cnxn.close()\n                raise\n            #return (OUT_OUTPUT_MSG,OUT_IS_MAIL_CLASSIFIED,OUT_CLASSIFIED_CLIENT_ID,OUT_CLASSIFIED_CLIENT_NAME)\n    except:\n        loginfo(traceback.format_exc(),'ClassifySenderEmail()')\n          \n    \n    \n\n\nClassifySenderEmail()\n#print('Classification program processed successfully')\n"}},{"name":"version","value":{"type":"STRING","string":"3"}}]},{"uid":"19acecd0-d5b2-43b0-9a21-d3c3f6610c72","commandName":"python.commands.executeScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default1"}}]},{"uid":"5be5b580-5b83-4bef-ad25-12b666e6d626","commandName":"python.commands.closeScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default1"}}]},{"uid":"590fc13d-6798-473c-afba-fe4929abd092","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"5a36660f-3934-4e63-a1ee-6febb01267c3","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$DB_Record{ID}$"}}],"returnTo":{"type":"VARIABLE","variableName":"EmailLogID1"}},{"uid":"24c26071-e9a9-4b01-b51b-af78d762c13e","commandName":"store","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","string":"USP_GetClientIDFromEmailLog"}},{"name":"entryList","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"inOrOutParamter","value":{"type":"STRING","string":"Input"}},{"key":"parametername","value":{"type":"STRING","string":"@ID"}},{"key":"parametervalue","value":{"type":"STRING","expression":"$DB_Record{ID}$"}},{"key":"outputParamType","value":{"type":"STRING","string":"INTEGER"}}]}]}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"636e2e53-d147-42fe-810f-78dbf9249bb8","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"ce3cd1fd-19f4-4368-b79a-d79bf46b89ab","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"1aa520a6-c077-49fa-adda-2aec6b394d30","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Yes"}}],"returnTo":{"type":"VARIABLE","variableName":"ClientClassification"}},{"uid":"e50a3e04-1527-4d36-9dfa-4789268365f5","commandName":"store","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","string":"USP_GET_CLIENT_DETAIL_MASTER"}},{"name":"entryList","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"inOrOutParamter","value":{"type":"STRING","string":"Input"}},{"key":"parametername","value":{"type":"STRING","string":"@CLIENTID"}},{"key":"parametervalue","value":{"type":"STRING","expression":"$EMAIL_Record{CLIENTID}$"}},{"key":"outputParamType","value":{"type":"STRING","string":"INTEGER"}}]}]}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"bcf2da01-2db3-4ff5-949d-b59f843da113","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"edce3b3e-df92-4384-8904-452cc66c3a68","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$MASTER_RECORD{\"DOWNLOAD_PATH\"}$"}}],"returnTo":{"type":"VARIABLE","variableName":"download_path"}},{"uid":"f754c940-a2dc-4fd9-89c0-bb8968ea27f5","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"360315f0-b572-43dc-98a3-73af4e70327b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$MASTER_RECORD{\"DOWNLOAD_PATH\"}$\\$MASTER_RECORD{\"DownloadFolderName\"}$"}}],"returnTo":{"type":"VARIABLE","variableName":"download_path2"}},{"uid":"9907edc7-cb9c-4d71-89f0-60e4cc2b2244","commandName":"if","packageName":"If","disabled":false,"children":[],"branches":[{"uid":"37729063-6897-4ede-953b-f7e292eaca07","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"fc595606-9ded-45ab-a990-5a7476ac42fb","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$MASTER_RECORD{\"DOWNLOAD_PATH\"}$\\$MASTER_RECORD{\"DownloadFolderName\"}$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$download_path2$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderExists","packageName":"Folder"}}]},{"uid":"b2b1547c-ee59-4448-9861-96a313c070e2","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$MASTER_RECORD{\"DOWNLOAD_PATH\"}$\\$MASTER_RECORD{\"DownloadFolderName\"}$\\$DB_Record{ID}$"}}],"returnTo":{"type":"VARIABLE","variableName":"createfolder2"}},{"uid":"e80ffe35-9f14-4276-a34c-c6886d9ab9af","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$MASTER_RECORD{\"DOWNLOAD_PATH\"}$\\$MASTER_RECORD{\"DownloadFolderName\"}$\\$DB_Record{ID}$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"8533edc0-04df-4a32-a25e-317194f9a43f","commandName":"saveAttachment","packageName":"Email","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$MASTER_RECORD{\"DOWNLOAD_PATH\"}$\\$MASTER_RECORD{\"DownloadFolderName\"}$\\$DB_Record{ID}$"}},{"name":"checkOverrwrite","value":{"type":"BOOLEAN","boolean":true}}]}],"branches":[{"uid":"b98f4a28-5b01-49db-9e94-dabc7d1a181d","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"a92df520-1e06-49d8-9d3f-4b6447a91f95","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"fOLDER pATH"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$download_path$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderExists","packageName":"Folder"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"MASTER_RECORD"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"208b7e09-643a-4f3b-bad3-e2256305e258","commandName":"python.commands.openScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Defaultexr"}},{"name":"scriptOption","value":{"type":"STRING","string":"FILE"}},{"name":"file","value":{"type":"FILE","string":"file:///D:/HPU/dataextraction_Version_5.py"}},{"name":"version","value":{"type":"STRING","string":"3"}}]},{"uid":"57e6a9b5-310b-4c33-82ad-61e4d8c9098d","commandName":"python.commands.executeFunction","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Defaultexr"}},{"name":"functionName","value":{"type":"STRING","string":"mainex()"}}]},{"uid":"a3dc5bc3-a95f-4aaf-ad03-bcfb25d71dc2","commandName":"python.commands.closeScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Defaultexr"}}]},{"uid":"832bde70-1cee-443c-ad6b-13da2e4b329f","commandName":"python.commands.openScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sendmail"}},{"name":"scriptOption","value":{"type":"STRING","string":"FILE"}},{"name":"file","value":{"type":"FILE","string":"file:///D:/HPU/SendException_4.py"}},{"name":"version","value":{"type":"STRING","string":"3"}}]},{"uid":"862f602f-f289-4527-93a6-83691acf838d","commandName":"python.commands.executeFunction","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sendmail"}},{"name":"functionName","value":{"type":"STRING","string":"mainsendmail()"}}]},{"uid":"5c657561-9a4a-440e-9c14-0fad95e9d251","commandName":"python.commands.closeScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sendmail"}}]},{"uid":"b17e625f-76d8-424b-b0bd-430d81e65ee4","commandName":"python.commands.openScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"CensusG"}},{"name":"scriptOption","value":{"type":"STRING","string":"FILE"}},{"name":"file","value":{"type":"FILE","string":"file:///D:/HPU/Census_Gen_File_Version_4.py"}},{"name":"version","value":{"type":"STRING","string":"3"}}]},{"uid":"58d731c9-e105-49ad-8647-025c1b11d96a","commandName":"python.commands.executeFunction","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"CensusG"}},{"name":"functionName","value":{"type":"STRING","string":"CensusGenerationFun()"}}]},{"uid":"79ee8b27-4228-4618-976d-94b9a050cc9b","commandName":"python.commands.closeScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"CensusG"}}]},{"uid":"be4dfb1a-0e74-4c65-a500-2e465ce1d927","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"62298dbe-48f2-4f42-b8ad-e44e01635a02","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Sample%20bots/Send_Census_Email_31_Oct"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[{"uid":"17b44a2c-f85d-4094-9d95-ad73bc57689e","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]}],"branches":[{"uid":"82cd773f-b1ea-4928-880d-78ed88a411f7","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"54fbcaf4-b54b-49c1-a5c7-dbd59cd8d720","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"No"}}],"returnTo":{"type":"VARIABLE","variableName":"ClientClassification"}},{"uid":"82cf2e69-75d1-4351-8f2c-9ee7ba0ef4e3","commandName":"python.commands.openScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Defaultexr"}},{"name":"scriptOption","value":{"type":"STRING","string":"FILE"}},{"name":"file","value":{"type":"FILE","string":"file:///D:/HPU/dataextraction_Version_5.py"}},{"name":"version","value":{"type":"STRING","string":"3"}}]},{"uid":"c2409083-cc92-4660-bd2c-c6e3ce36d6e4","commandName":"python.commands.executeFunction","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Defaultexr"}},{"name":"functionName","value":{"type":"STRING","string":"mainex()"}}]},{"uid":"698a7737-717b-4eb9-b4fd-e693e3d7ec77","commandName":"python.commands.closeScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Defaultexr"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$EMAIL_Record{CLIENTID}$"}},{"name":"operator","value":{"type":"STRING","string":"GT"}},{"name":"value","value":{"type":"NUMBER","number":"1"}}],"value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"EMAIL_Record"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"DB_Record"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"UnReadMail"},"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"EmailSession"}},{"name":"readStatus","value":{"type":"STRING","string":"UNREAD"}},{"name":"folder","value":{"type":"STRING","string":"Inbox"}},{"name":"subject","value":{"type":"STRING","string":""}},{"name":"from","value":{"type":"STRING","string":""}},{"name":"messageFormat","value":{"type":"STRING","string":"HTML"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.email","packageName":"Email"}}]},{"uid":"7a2a4186-c019-4fa0-8944-9dba97e5cf86","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]},{"uid":"2a6d1e72-422e-43ca-8fe5-14da66925ebe","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"1861a11d-af79-4a64-9d6d-c86d17b5b411","commandName":"python.commands.openScript","packageName":"Python","disabled":true,"attributes":[{"name":"session","value":{"type":"STRING","string":"Defaultexr"}},{"name":"scriptOption","value":{"type":"STRING","string":"FILE"}},{"name":"file","value":{"type":"FILE","string":"file:///D:/vijay/dataextraction_Version_3.py"}},{"name":"version","value":{"type":"STRING","string":"3"}}]},{"uid":"002e8060-99c0-4bba-b202-b0aa3eb69e90","commandName":"python.commands.executeFunction","packageName":"Python","disabled":true,"attributes":[{"name":"session","value":{"type":"STRING","string":"Defaultexr"}},{"name":"functionName","value":{"type":"STRING","string":"mainex()"}}]},{"uid":"2fd8f561-4d3a-42e8-ba5c-9e2f2f5023ca","commandName":"python.commands.closeScript","packageName":"Python","disabled":true,"attributes":[{"name":"session","value":{"type":"STRING","string":"Defaultexr"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$ClientClassification$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":"Yes"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"7baa8f3d-d7e3-4456-929c-560366c93cbe","commandName":"python.commands.openScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sendmail"}},{"name":"scriptOption","value":{"type":"STRING","string":"FILE"}},{"name":"file","value":{"type":"FILE","string":"file:///D:/HPU/SendException_4.py"}},{"name":"version","value":{"type":"STRING","string":"3"}}]},{"uid":"3f0978e6-8708-4a96-8be2-b907a55c40ab","commandName":"python.commands.executeFunction","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sendmail"}},{"name":"functionName","value":{"type":"STRING","string":"mainsendmail()"}}]},{"uid":"8e824569-8b00-473d-bd41-ebd9b17cc85e","commandName":"python.commands.closeScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sendmail"}}]},{"uid":"1170681a-5c75-41df-a9a9-ec9f7bd8ec99","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"d5f9f177-0f68-49d2-8bbf-cad4675be269","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Sample%20bots/Send_Census_Email_31_Oct"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[{"uid":"4a6ff270-6cb3-463c-947d-e76271f62584","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]}],"branches":[{"uid":"6f42bafc-6702-4e72-826f-dbd46dd63042","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"e815a288-f563-4b6e-a09e-9574ac0695f7","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$ExceptionLine$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"ExceptionLineString"}},{"uid":"86c21787-ef51-42d5-9d1f-f99b72acd426","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file:///D:/HPUBOT_LOG/$Date$_Auto.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"$Exception$/ LineNo=$ExceptionLineString$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Exception"},"errorLineNumber":{"type":"VARIABLE","variableName":"ExceptionLine"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"UnReadMail","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"DB_Record","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"EmailLogID1","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"EMAIL_Record","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"EmailLogID","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"MASTER_RECORD","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"EachFile","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"download_path","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"$MASTER_RECORD{\"DOWNLOAD_PATH\"}$"}},{"name":"download_path2","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"createfolder2","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"EmailSubject","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"EmailMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"From_Email","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"ClientClassification","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"Email_ReceivedDate","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"Date","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"Exception","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"ExceptionLine","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"ExceptionLineString","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Database","version":"2.1.0-20200913-060112"},{"name":"Datetime","version":"2.2.0-20200831-031025"},{"name":"Email","version":"3.0.0-20200901-105426"},{"name":"ErrorHandler","version":"2.1.0-20200831-031055"},{"name":"Folder","version":"2.2.0-20200831-031100"},{"name":"If","version":"2.1.0-20200825-071156"},{"name":"LogToFile","version":"2.2.0-20200831-031539"},{"name":"Loop","version":"2.1.0-20200831-031540"},{"name":"MessageBox","version":"2.1.0-20200831-031541"},{"name":"Number","version":"2.1.0-20200831-031551"},{"name":"Python","version":"2.1.0-20200831-031850"},{"name":"String","version":"3.1.0-20200831-031943"},{"name":"System","version":"3.0.0-20200831-031944"},{"name":"TaskBot","version":"2.0.1-20200907-072949"}],"workItemTemplateName":null}